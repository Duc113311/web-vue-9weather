<template>
  <div class="w-[1800px] flex justify-between items-center">
    <div
      class="weather-item w-[70px]"
      v-for="(item, index) in paramHourly"
      :key="index"
    >
      <!-- <span class="txt">{{ renderHourly(item).timestampValue }}</span> -->
      <div class="flex justify-center items-center">
        <component :is="renderHourlyIcon(item.precipIntensity)"></component>
      </div>
      <div class="">
        <p class="txt_regular_12">
          {{ Math.round(item.precipProbability * 100) }}%
        </p>
        <p class="txt_regular_12">
          {{ item.precipIntensity === 0 ? "0.0" : item.precipIntensity }}
          {{ unitPrecipitation }}
        </p>
      </div>
    </div>
  </div>
</template>
<script>
import {
  codeToFind,
  convertTimestamp12hSun,
  convertTimestamp24hSun,
  convertTimestampToHoursMinutes,
  convertTimestampToHoursMinutes12,
  getIconChartPrecipIntensity,
  getIconHourlyForecastTheme,
} from "@/utils/converValue";
import { mapGetters } from "vuex";

export default {
  name: "chart-precipitation",

  computed: {
    ...mapGetters("weatherModule", ["hourly24hGetters"]),
    paramHourly() {
      const daily = this.$store.state.weatherModule.dailyData;
      const listDaily30Day = this.$store.state.weatherModule.listDaily30Day;
      if (daily.length !== 0) {
        listDaily30Day.splice(0, 8, ...daily);
      }

      return listDaily30Day;
    },

    convertTimeMonth() {
      return this.paramHourly.map((item) => {
        const date = item.time;
        return this.convertTime(date);
      });
    },

    unitPrecipitation() {
      const unitSetting = this.$store.state.commonModule.objectSettingSave;
      return codeToFind(unitSetting.activePrecipitation_save);
    },
  },

  methods: {
    renderHourlyIcon(value) {
      const iconValue = getIconChartPrecipIntensity(value);

      return iconValue;
    },

    convertTime(val) {
      const offsetValue = this.$store.state.weatherModule.locationOffset.offset;
      const timezoneValue =
        this.$store.state.weatherModule.locationOffset.timezone;
      const unitSetting = this.$store.state.commonModule.objectSettingSave;

      if (unitSetting.activeTime_save === "12h") {
        return convertTimestamp12hSun(val, 1, offsetValue, timezoneValue);
      } else {
        return convertTimestamp24hSun(val, 1, offsetValue, timezoneValue);
      }
    },

    renderHourlyTime(value) {
      const offsetValue = this.$store.state.weatherModule.locationOffset.offset;
      const timezoneValue =
        this.$store.state.weatherModule.locationOffset.timezone;

      //   const iconValue = getIconHourlyForecastTheme(value.icon);
      const unitSetting = this.$store.state.commonModule.objectSettingSave;
      const timestampValue =
        unitSetting.activeTime_save === "12h"
          ? convertTimestampToHoursMinutes12(
              value.time,
              0,
              offsetValue,
              timezoneValue
            )
          : convertTimestampToHoursMinutes(
              value.time,
              0,
              offsetValue,
              timezoneValue
            );
      return timestampValue;
    },
  },
};
</script>
<style lang="scss">
.p-chart-avg-new {
  padding-left: 10x;
  padding-right: 10px;
}
</style>
